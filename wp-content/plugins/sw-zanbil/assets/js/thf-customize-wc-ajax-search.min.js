const THF_Customize_WC_Ajax_Search_Product={init(){isset(window.THF_AJAX_SEARCH_PRODUCT)&&(window.THF_AJAX_SEARCH_PRODUCT=null,delete window.THF_AJAX_SEARCH_PRODUCT),window.THF_AJAX_SEARCH_PRODUCT=THF_Customize_WC_Ajax_Search_Product.constructor()},constructor(){this.defineVariables(),this.setup(),this.events()},defineVariables(){this.$doc=jQuery(document),this.$window=jQuery(window),this.$searchForm=jQuery("#searchform_special",this.$doc),this.$searchInput=jQuery('input[name="s"]',this.$searchForm),this.$searchInputSelect=jQuery('select[name="search_category"]',this.$searchForm),this.$searchSubmitBtn=jQuery(".button-search-pro",this.$searchForm),this.$searchSubmitBtn.after('<div class="search-result"></div>'),this.$searchResult=jQuery(".search-result",this.$searchForm),this.$searchSpinnerIcon=THF.spinner,this.$searchSpinner=jQuery('<div class="search-spinner d-flex align-center justify-center">'+this.$searchSpinnerIcon+"</div>"),this.searchTypeDelay=0,this.searchMinCharsToSearch=3,this.searchToBeExecuted=null},setup(){const e=this;e.$searchForm.addClass("ajax-search"),e.$searchInput.attr("autocomplete","off"),e.$doc.mouseup(function(t){let s=e.$searchForm;s.is(t.target)||0!==s.has(t.target).length||(e.searchSpinner("hide"),e.$searchResult.html("").hide())})},events(){const e=this;e.$searchInput.keyup(function(t){let s=jQuery.trim(jQuery(this).val()).length,r=String.fromCharCode(t.keyCode).match(/\w/),a=8===t.keyCode||46===t.keyCode;e.clearSearchTimeout(),(r||a)&&(s>=e.searchMinCharsToSearch&&0!==s?e.searchTimeout=setTimeout(()=>e.searchProduct(),e.searchTypeDelay):(e.$searchResult.hide(),e.searchSpinner("hide")))}),e.$searchInputSelect.change(function(){e.clearSearchTimeout(),e.searchProduct()})},clearSearchTimeout(){const e=this;e.searchTimeout&&clearTimeout(e.searchTimeout)},searchProduct(){const e=this;if(is_empty(e.searchToBeExecuted)||(e.searchToBeExecuted.abort(),e.searchToBeExecuted=null),e.searchCurrentData={action:"thf_woocommerce_search_product",search:jQuery.trim(e.$searchInput.val())||null,category:e.$searchInputSelect.val()||null},is_empty(e.searchCurrentData.search))return!1;e.searchToBeExecuted=ajaxRequest({data:e.searchCurrentData,beforeSend:function(){e.searchSpinner("show")},success:function(t){e.searchSpinner("hide"),t.success?e.$searchResult.html(t.data.html).show():isset(t.data.msg)&&e.$searchResult.html(t.data.msg).show()}})},searchSpinner(e){const t=this,s=t.$searchResult.attr("data-icon");"show"===e&&"spinner"!==s?t.$searchResult.html(t.$searchSpinner).attr("data-icon","spinner").show():"show"!==e&&"spinner"===s&&t.$searchResult.html("").attr("data-icon","search")}};jQuery(document).ready(function(){THF_Customize_WC_Ajax_Search_Product.init()});